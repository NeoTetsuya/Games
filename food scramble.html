<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Scramble Activity - Drag & Drop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Kalam:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .title-font {
            font-family: 'Kalam', cursive;
        }
        .number-button {
            transition: all 0.3s ease;
        }
        .number-button:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .number-button.active {
            background-color: #4f46e5;
            color: white;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        #recipe-display {
            transition: opacity 0.5s ease-in-out;
        }
        .step-item {
            cursor: grab;
            user-select: none;
            transition: background-color 0.2s ease;
        }
        .step-item:active {
            cursor: grabbing;
        }
        .step-item.dragging {
            opacity: 0.5;
            background: #c7d2fe;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold title-font text-indigo-600">Recipe Scramble!</h1>
            <p class="text-lg text-gray-600 mt-2">Choose a recipe, then drag and drop the steps into the correct order.</p>
        </header>

        <!-- Recipe Number Selection -->
        <div id="recipe-selection" class="flex flex-wrap justify-center gap-4 mb-8">
            <!-- Buttons will be generated by JavaScript -->
        </div>

        <!-- Recipe Display Area -->
        <div id="recipe-display" class="bg-white rounded-2xl shadow-xl p-6 md:p-8 opacity-100 min-h-[500px] flex flex-col items-center justify-center">
             <div id="initial-message" class="text-center">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                  <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
                <h3 class="mt-2 text-xl font-semibold text-gray-900">Select a recipe to unlock</h3>
                <p class="mt-1 text-base text-gray-500">Click on a number above to get started.</p>
              </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="password-modal" class="modal fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900">Enter Password</h3>
                <form id="password-form" class="mt-4">
                    <input type="password" id="password-input" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="Password">
                    <p id="password-error" class="text-red-500 text-sm mt-2 h-5"></p>
                    <div class="items-center px-4 py-3">
                        <button type="submit" class="px-4 py-2 bg-indigo-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-300">
                            Unlock
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
      <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
          <div id="modal-icon" class="mx-auto flex items-center justify-center h-12 w-12 rounded-full"></div>
          <h3 id="modal-title" class="text-lg leading-6 font-medium text-gray-900"></h3>
          <div class="mt-2 px-7 py-3">
            <p id="modal-message" class="text-sm text-gray-500"></p>
          </div>
          <div class="items-center px-4 py-3">
            <button id="modal-close" class="px-4 py-2 bg-indigo-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-300">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
        // --- DATA ---
        // Passwords have been added.
        const recipes = [
            {
                id: 1, title: "Spicy Egg Pizza", password: "nhom5maidinh",
                steps: [
                    { stepNumber: 1, text: "In 1T olive oil: Sauté 2 crushed garlic cloves and 1t chilli flakes for a few minutes on medium heat.", imageSrc: "https://i.postimg.cc/bv3wvwvw/Step1.png" },
                    { stepNumber: 2, text: "Add 200g tomato paste (3/4C), mix well and take off the heat.", imageSrc: "https://i.postimg.cc/9MkXGgZ3/Step2.png" },
                    { stepNumber: 3, text: "Roll Basic Pizza Dough to desired thickness and cover with the sauce and 100g mozzarella.", imageSrc: "https://i.postimg.cc/Jz8XDtRN/Step3.png" },
                    { stepNumber: 4, text: "Add 2 eggs.", imageSrc: "https://i.postimg.cc/fRM3WFv5/Step4.png" },
                    { stepNumber: 5, text: "Bake at 230°C (450°F) for 12-15 min.", imageSrc: "https://i.postimg.cc/HLhj2L1P/Step5.png" }
                ]
            },
            {
                id: 2, title: "Nut Milks", password: "nhom5dinhchop",
                steps: [
                    { stepNumber: 1, text: "Cover 1 part nuts with water. Soak overnight.", imageSrc: "https://i.postimg.cc/T1Z8PZmw/Step1.png" },
                    { stepNumber: 2, text: "Drain the nuts.", imageSrc: "https://i.postimg.cc/pXFbSLbn/Step2.png" },
                    { stepNumber: 3, text: "Blend with 2 parts hot water.", imageSrc: "https://i.postimg.cc/L8FKFF2Q/Step3.png" },
                    { stepNumber: 4, text: "Blend or pulse till no more particles are visible.", imageSrc: "https://i.postimg.cc/kgNrnY5J/Step4.png" },
                    { stepNumber: 5, text: "Transfer to bottle and refrigerate.", imageSrc: "https://i.postimg.cc/k570DNVx/Step5.png" }
                ]
            },
            {
                id: 3, title: "Crackers", password: "nhom5dabest",
                steps: [
                    { stepNumber: 1, text: "Whisk 420g plain flour (3C), 2t sugar, 2t salt.", imageSrc: "https://i.postimg.cc/pXxpW4Wr/Step1.png" },
                    { stepNumber: 2, text: "Stir in 200ml water (3/4C) and 60ml olive oil (4T).", imageSrc: "https://i.postimg.cc/jS35hjzn/Step2.png" },
                    { stepNumber: 3, text: "The dough will be soft and sticky. Divide into 2-3 balls & spread on baking paper as thinly as possible.", imageSrc: "https://i.postimg.cc/QMRdRnYX/Step3.png" },
                    { stepNumber: 4, text: "Sprinkle topping(s) of choice.", imageSrc: "https://i.postimg.cc/Tw6Xj8HW/Step4.png" },
                    { stepNumber: 5, text: "Press topping into dough.", imageSrc: "https://i.postimg.cc/T3g7Vy8C/Step5.png" },
                    { stepNumber: 6, text: "Prick with fork all over. Lightly mark break lines.", imageSrc: "https://i.postimg.cc/nLxd0HpZ/Step6.png" },
                    { stepNumber: 7, text: "Bake at 220°C / 425°F for 12-15 min till edges browned.", imageSrc: "https://i.postimg.cc/MTK9JdnF/Step7.png" }
                ]
            },
            {
                id: 4, title: "Walnut Poppy Seed Pasta", password: "nhom5xinhdep",
                steps: [
                    { stepNumber: 1, text: "Simmer 350g linguine (12oz) with a pinch of salt till just soft.", imageSrc: "https://i.postimg.cc/NFhM3PM6/Step1.png" },
                    { stepNumber: 2, text: "In a separate pot, sauté 4 minced garlic cloves in 3T butter on medium heat until slightly golden.", imageSrc: "https://i.postimg.cc/D0qZndJt/Step2.png" },
                    { stepNumber: 3, text: "Add 1/3C poppy seeds and cook for 1 min.", imageSrc: "https://i.postimg.cc/sD4XLmRW/Step3.png" },
                    { stepNumber: 4, text: "Add 1/3C chopped walnuts and a pinch of salt. Cook for 1 min.", imageSrc: "https://i.postimg.cc/5tTNzk8h/Step4.png" },
                    { stepNumber: 5, text: "Add the drained linguine, zest of 1-2 lemons, and toss to coat. Serve at once.", imageSrc: "https://i.postimg.cc/Y0wrnGn8/Step5.png" }
                ]
            },
            {
                id: 5, title: "Cooking Pasta", password: "nhom5lanhat",
                steps: [
                    { stepNumber: 1, text: "Boil water in a large pot and add salt.", imageSrc: "https://i.postimg.cc/Mpf7RgBw/Step1.png" },
                    { stepNumber: 2, text: "Add pasta to the boiling water.", imageSrc: "https://i.postimg.cc/Rh83ZVXH/Step2.png" },
                    { stepNumber: 3, text: "Cook for approximately 5-7 minutes, stirring occasionally.", imageSrc: "https://i.postimg.cc/RCbJRX4Z/Step3.png" },
                    { stepNumber: 4, text: "Drain the cooked pasta using a colander.", imageSrc: "https://i.postimg.cc/SN22tCx7/Step4.png" }
                ]
            },
            {
                id: 6, title: "Banana Omelette", password: "nhom5tuyevoi",
                steps: [
                    { stepNumber: 1, text: "In a knob of butter, briefly fry 2 sliced bananas on medium heat.", imageSrc: "https://i.postimg.cc/g2F42YwR/Step1.png" },
                    { stepNumber: 2, text: "Add 4 eggs and stir.", imageSrc: "https://i.postimg.cc/x1v5kWHZ/Step2.png" },
                    { stepNumber: 3, text: "Add a pinch of salt, a pinch of sugar, and a pinch of cardamom.", imageSrc: "https://i.postimg.cc/B6VB9s9j/Step3.png" },
                    { stepNumber: 4, text: "Serve with Arabic or other bread.", imageSrc: "https://i.postimg.cc/zDy9LGfP/Step4.png" }
                ]
            },
            {
                id: 7, title: "Chocolate Nut Cake", password: "ilovegroup5",
                steps: [
                    { stepNumber: 1, text: "In a double boiler, melt: 250g dark chocolate (8oz), 150g butter (3/4C), 100g chopped walnuts (1C).", imageSrc: "https://i.postimg.cc/43FWZpp4/Step1.png" },
                    { stepNumber: 2, text: "In a separate bowl, beat 3 eggs and 200g sugar (1C) till light and foamy.", imageSrc: "https://i.postimg.cc/Qxr0X8K7/Step2.png" },
                    { stepNumber: 3, text: "In another bowl, mix 150g flour (1.25C) and 1t baking powder.", imageSrc: "https://i.postimg.cc/XYjLCs87/Step3.png" },
                    { stepNumber: 4, text: "Add the flour mix to the egg mix and beat till just blended.", imageSrc: "https://i.postimg.cc/qv1LX2bc/Step4.png" },
                    { stepNumber: 5, text: "Fold in the chocolate mix.", imageSrc: "https://i.postimg.cc/1z4KW42k/Step5.png" },
                    { stepNumber: 6, text: "Pour into greased baking tin. Garnish with walnut halves.", imageSrc: "https://i.postimg.cc/3Rmm6GBc/Step6.png" },
                    { stepNumber: 7, text: "Bake at 180°C / 350°F for 35 min.", imageSrc: "https://i.postimg.cc/qqGnBdWc/Step7.png" }
                ]
            },
            {
                id: 8, title: "Homemade Bread", password: "group5ismylove",
                steps: [
                    { stepNumber: 1, text: "Mix flour, sugar, salt, yeast, water, and olive oil in a bowl.", imageSrc: "https://i.postimg.cc/HscdCt5n/Step1.png" },
                    { stepNumber: 2, text: "Knead the dough.", imageSrc: "https://i.postimg.cc/13DS85vZ/Step2.png" },
                    { stepNumber: 3, text: "Cover the dough and let it rise for 40 minutes.", imageSrc: "https://i.postimg.cc/5t1VLdrQ/Step5.png" },
                    { stepNumber: 4, text: "Bake at 180° until cooked.", imageSrc: "https://i.postimg.cc/rpJL9Z6n/Step4.png" },
                    { stepNumber: 5, text: "Bon appetit!", imageSrc: "https://i.postimg.cc/mDgWp3Bb/Step5.png" }
                ]
            },
            {
                id: 9, title: "How to Make Pancakes", password: "nhom5iudau",
                steps: [
                    { stepNumber: 1, text: "Combine 200g flour, 1.5g baking powder, 1 egg, sugar to taste, 2 tablespoons olive oil, 210ml warm milk, and salt to taste.", imageSrc: "https://i.postimg.cc/kX3qqbyy/Step1.png" },
                    { stepNumber: 2, text: "Mix everything together.", imageSrc: "https://i.postimg.cc/cCqyxpfJ/Step2.png" },
                    { stepNumber: 3, text: "Bake on a pan.", imageSrc: "https://i.postimg.cc/4NgkrTJL/Step3.png" },
                    { stepNumber: 4, text: "Serve with fruits or berries and honey or syrup.", imageSrc: "https://i.postimg.cc/NM6bXSWF/Step4.png" }
                ]
            }
        ];

        // --- STATE ---
        let currentRecipeId = null;

        // --- DOM ELEMENTS ---
        const selectionContainer = document.getElementById('recipe-selection');
        const displayContainer = document.getElementById('recipe-display');
        const passwordModal = document.getElementById('password-modal');
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password-input');
        const passwordError = document.getElementById('password-error');
        const feedbackModal = document.getElementById('feedback-modal');
        const modalCloseBtn = document.getElementById('modal-close');

        // --- FUNCTIONS ---

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function showFeedback(isCorrect) {
            const modalIcon = document.getElementById('modal-icon');
            const modalTitle = document.getElementById('modal-title');
            const modalMessage = document.getElementById('modal-message');

            if (isCorrect) {
                modalIcon.innerHTML = `<svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg>`;
                modalIcon.className = 'mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-500';
                modalTitle.textContent = 'Correct!';
                modalMessage.textContent = 'Great job! You put the steps in the right order.';
            } else {
                modalIcon.innerHTML = `<svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>`;
                modalIcon.className = 'mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-500';
                modalTitle.textContent = 'Not Quite!';
                modalMessage.textContent = 'Some steps are out of order. Try dragging them again!';
            }
            feedbackModal.classList.remove('hidden');
        }
        
        function checkOrder() {
            const items = document.querySelectorAll('#steps-list .step-item');
            if (items.length === 0) return;
            let isCorrect = true;
            items.forEach((item, index) => {
                const correctStep = index + 1;
                const currentStep = parseInt(item.dataset.step, 10);
                if (correctStep !== currentStep) {
                    isCorrect = false;
                }
            });
            showFeedback(isCorrect);
        }

        function displayRecipe(recipeId) {
            const recipe = recipes.find(r => r.id === recipeId);
            if (!recipe) return;

            document.querySelectorAll('.number-button').forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.dataset.recipeId) === recipeId) {
                    btn.classList.add('active');
                }
            });

            const shuffledSteps = [...recipe.steps];
            shuffleArray(shuffledSteps);

            const recipeHtml = `
                <div class="w-full text-center">
                    <h2 class="text-3xl font-bold title-font text-gray-800 mb-2">${recipe.title}</h2>
                    <p class="text-gray-500 mb-6">Drag and drop the steps to put them in the right order.</p>
                </div>
                <div class="w-full max-w-2xl">
                    <ul id="steps-list" class="space-y-4">
                        ${shuffledSteps.map(step => `
                            <li class="step-item bg-white p-4 rounded-lg shadow-md flex items-center space-x-4 border" draggable="true" data-step="${step.stepNumber}">
                                <img src="${step.imageSrc}" alt="Visual for a recipe step" class="w-24 h-24 object-cover rounded-md bg-gray-200" onerror="this.src='https://placehold.co/24x24/e2e8f0/4a5568?text=?'; this.classList.add('p-8');">
                                <p class="flex-1 text-gray-700">${step.text}</p>
                                <svg class="w-6 h-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
                            </li>
                        `).join('')}
                    </ul>
                </div>
                <div class="mt-8">
                    <button id="check-order-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-105">
                        Check My Order
                    </button>
                </div>
            `;

            displayContainer.style.opacity = 0;
            setTimeout(() => {
                displayContainer.innerHTML = recipeHtml;
                setupDragAndDrop();
                document.getElementById('check-order-btn').addEventListener('click', checkOrder);
                displayContainer.style.opacity = 1;
            }, 300);
        }
        
        function setupDragAndDrop() {
            const list = document.getElementById('steps-list');
            if(!list) return;
            let draggingElement = null;

            list.addEventListener('dragstart', e => {
                if (e.target.classList.contains('step-item')) {
                    draggingElement = e.target;
                    setTimeout(() => e.target.classList.add('dragging'), 0);
                }
            });

            list.addEventListener('dragend', e => {
                if (draggingElement) {
                    draggingElement.classList.remove('dragging');
                    draggingElement = null;
                }
            });

            list.addEventListener('dragover', e => {
                e.preventDefault();
                const afterElement = getDragAfterElement(list, e.clientY);
                const currentDragging = document.querySelector('.dragging');
                if(!currentDragging) return;
                
                if (afterElement == null) {
                    list.appendChild(currentDragging);
                } else {
                    list.insertBefore(currentDragging, afterElement);
                }
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.step-item:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function promptForPassword(recipeId) {
            currentRecipeId = recipeId;
            passwordInput.value = '';
            passwordError.textContent = '';
            passwordModal.classList.remove('hidden');
            passwordInput.focus();
        }

        function handlePasswordSubmit(e) {
            e.preventDefault();
            const recipe = recipes.find(r => r.id === currentRecipeId);
            const enteredPassword = passwordInput.value;

            if (recipe && enteredPassword === recipe.password) {
                passwordModal.classList.add('hidden');
                displayRecipe(currentRecipeId);
            } else {
                passwordError.textContent = 'Incorrect password. Please try again.';
                passwordInput.value = '';
            }
        }

        function initialize() {
            recipes.forEach(recipe => {
                const button = document.createElement('button');
                button.textContent = recipe.id;
                button.dataset.recipeId = recipe.id;
                button.className = 'number-button bg-white shadow-md rounded-full w-14 h-14 flex items-center justify-center text-xl font-bold text-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500';
                button.addEventListener('click', () => promptForPassword(recipe.id));
                selectionContainer.appendChild(button);
            });
            
            passwordForm.addEventListener('submit', handlePasswordSubmit);
            modalCloseBtn.addEventListener('click', () => feedbackModal.classList.add('hidden'));
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', initialize);
    </script>

</body>
</html>
